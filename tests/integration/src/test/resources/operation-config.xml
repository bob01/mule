<?xml version="1.0" encoding="UTF-8"?>
<mule xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="
       http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd">

    <config name="aConfig">
        <parameters>
            <parameter parameterName="configParam"/>
        </parameters>
    </config>

    <config-ref name="aConfigInstance" config="aConfig">
        <parameter parameterName="configParam" value="testVarConfigValue"/>
    </config-ref>

    <operation name="operationWithConfig" config="aConfig">
        <parameters>
            <parameter parameterName="in1"/>
        </parameters>
        <body>
            <set-payload value="$[in1]"/>
            <set-variable variableName="testVar" value="$[config:configParam]"/>
        </body>
    </operation>

    <operation name="operation">
        <parameters>
            <parameter parameterName="in1"/>
            <parameter parameterName="in2" defaultValue="testVarDefault"/>
        </parameters>
        <body>
            <set-payload value="$[in1]"/>
            <set-variable variableName="testVar" value="$[in2]"/>
        </body>
    </operation>

    <flow name="flow">
        <operation-ref operation="operation">
            <parameter parameterName="in1" value="hola amigoooooo"/>
            <parameter parameterName="in2" value="testVarValue"/>
        </operation-ref>
    </flow>

    <flow name="flow2">
        <operation-ref operation="operation" >
            <parameter parameterName="in1" value="hola amigoooooo2"/>
            <parameter parameterName="in2" value="testVarValue2"/>
        </operation-ref>
    </flow>

    <flow name="flow3">
        <operation-ref operation="operation" >
            <parameter parameterName="in1" value="hola amigoooooo3"/>
        </operation-ref>
    </flow>

    <flow name="flow4">
        <operation-ref operation="operationWithConfig" config="aConfigInstance" >
            <parameter parameterName="in1" value="hola amigoooooo4"/>
        </operation-ref>
    </flow>

</mule>
